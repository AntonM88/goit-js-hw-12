{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport const userParams = {\n  query: '',\n  page: 1,\n  perPage: 15,\n  maxPAge: '',\n};\n\nexport function fetchImages() {\n  const params = {\n    params: {\n      key: '43998127-099fd85a2e7628fabdc2ccde0',\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      q: userParams.query,\n      page: userParams.page,\n      per_page: userParams.perPage,\n    },\n  };\n\n  return axios.get('', params);\n}\n","export function imagesTemplate(arr) {\n  return arr.map(imgTemplate).join('');\n}\n\nfunction imgTemplate(img) {\n  return `<li class=\"gallery-item\">\n<div class='gallery'>\n  <a class=\"img-link\" href=\"${img.largeImageURL}\">\n    <img class=\"img-item\" src=\"${img.webformatURL}\" alt=\"${img.tags}\" />\n  </a>\n</div>\n<div class='text-box'>\n        <p class=\"text\">Likes ${img.likes}</p>\n        <p class=\"text\">Views ${img.views}</p>\n        <p class=\"text\">Comments ${img.comments}</p>\n        <p class=\"text\">Downloads ${img.downloads}</p>\n  </div>\n</li>`;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchImages, userParams } from './js/pixabay-api';\n\nimport { imagesTemplate } from './js/render-functions';\n\nlet lightbox = new SimpleLightbox('.js-gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst refs = {\n  formEl: document.querySelector('.js-form'),\n  inputEl: document.querySelector('.js-input'),\n  galleryEl: document.querySelector('.js-gallery'),\n  loader: document.querySelector('.loader'),\n  btnLoad: document.querySelector('.js-btn-load'),\n};\n\nrefs.formEl.addEventListener('submit', handleSubmit);\nrefs.btnLoad.addEventListener('click', onLoad);\n\nfunction handleSubmit(e) {\n  e.preventDefault();\n  refs.galleryEl.innerHTML = '';\n  hideBtnLoad();\n  userParams.query = e.target.elements.query.value.trim();\n  userParams.page = 1;\n\n  showLoader();\n\n  if (userParams.query === '') {\n    noImageMessage('Please enter a search query', 'tomato');\n\n    hideLoader();\n    return;\n  }\n\n  renderImg(userParams.query);\n\n  e.target.reset();\n}\n\nasync function renderImg() {\n  try {\n    const {\n      data: { hits, totalHits },\n    } = await fetchImages(userParams.query);\n\n    showBtnLoad();\n    if (hits.length === 0) {\n      hideBtnLoad();\n      noImageMessage(\n        'Sorry, there are no images matching your search query. Please try again!',\n        'red'\n      );\n      return;\n    }\n\n    refs.galleryEl.innerHTML = imagesTemplate(hits);\n\n    lightbox.refresh();\n\n    if (totalHits < userParams.perPage) {\n      hideBtnLoad();\n    } else {\n      showBtnLoad();\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function onLoad() {\n  showLoader();\n\n  userParams.page += 1;\n\n  try {\n    const {\n      data: { hits, totalHits },\n    } = await fetchImages();\n\n    if (hits.length === 0) {\n      noImageMessage(\n        'We are sorry, but you`ve reached the end of search results',\n        'DeepSkyBlue'\n      );\n\n      hideBtnLoad();\n\n      return;\n    }\n\n    const lastPage = Math.ceil(totalHits / userParams.perPage);\n\n    if (lastPage === userParams.page) {\n      hideBtnLoad();\n    }\n\n    refs.galleryEl.insertAdjacentHTML('beforeend', imagesTemplate(hits));\n\n    scrollPage();\n\n    lightbox.refresh();\n  } catch (error) {\n    noImageMessage('Error', 'red');\n  } finally {\n    hideLoader();\n    scrollPage();\n  }\n}\n\n// ==================\n\nfunction noImageMessage(message, backgroundColor) {\n  iziToast.error({\n    title: '',\n    message,\n    position: 'topRight',\n    backgroundColor,\n    messageColor: 'white',\n  });\n}\n\n// ==================\n\nfunction showLoader() {\n  refs.loader.classList.remove('is-hidden');\n}\n\nfunction hideLoader() {\n  refs.loader.classList.add('is-hidden');\n}\n\n// ==================\n\nfunction showBtnLoad() {\n  refs.btnLoad.classList.remove('is-hidden');\n}\n\nfunction hideBtnLoad() {\n  refs.btnLoad.classList.add('is-hidden');\n}\n\n// ==================\n\nfunction scrollPage() {\n  const liEl = refs.galleryEl.firstChild;\n  const height = liEl.getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["axios","userParams","fetchImages","params","imagesTemplate","arr","imgTemplate","img","lightbox","SimpleLightbox","refs","handleSubmit","onLoad","hideBtnLoad","showLoader","noImageMessage","hideLoader","renderImg","hits","totalHits","showBtnLoad","error","scrollPage","message","backgroundColor","iziToast","height"],"mappings":"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"}